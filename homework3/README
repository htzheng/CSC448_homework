In homework3, I implemented the CRF training. Specifically,
- I first implemented the forward-backward algorithm via PyTorch to compute alpha and beta. 
- next, I implemented the Maximum Bayes Risk to train the CRF. The equation is given by
   min  -sum_i alpha[i]*beta[i]
- To avoid overfitting, I additionally added a small l1 regularization on the transmission and emission matrices:
   l1_loss = l1_weight * (|transmission|_1 + |emission|_1)
- To get some intuition on to which extend training would help, I generated a fixed transmission and emission matrices using the expected word count on training data to compute the accuracy. Results shows that training can improve accuracy from the expected word cound method from 92.181% to 94.052%.
- The code is efficient and the training takes 8.5 mins to reach the accuracy of 94.052% on test set

Other implementation details include:
- forward and backward pass is implemented via batched operations. I also optimized the speed by using only 1 for loop to compute the entire alpha (Line 124) and beta (Line 131). Furthermore, I compute the logarithm of alpha and beta instead of the plain probability to improve numerical stadiblity. The update computation is based on the torch.logsumexp() function and other matrix operations.
- I also implement a batched decoding algorithm so that decoding the whole training/test sets takes only ~0.1 seconds.
- The training settings are: lr=0.002, max_iter=50000, batch_size=500, l1_weight=0.01. Training on a single GPU takes 8.5 mins (50000 iterations)

Results and observations:
- with l1 regularization, the marginal prediction accuracy is boosted to 94.052% on test set and 94.052% on training set. Using Viterbi decoding (not recommended because accuracy is lower), the accuracy is 93.232% on test set and 96.931% on training set. The final output of the program is:
    iteration [50000/50000], elapsed time [00:09:09], decode acc: [0.9323261976242065], forward-backward acc: [0.9405215382575989]
    training decode acc: [0.9693161845207214], training forward-backward acc: [0.9405215382575989]

- without l1 regularization, the marginal prediction accuracy is 92.628% on test set and 92.159% on training set. However, using Viterbi decoding (not recommended because accuracy is lower), the accuracy is 87.475% on test set and is lower than the training set accuracy (92.159%), indicating overfitting.  The final output of the program is:
    iteration [50000/50000], elapsed time [00:08:25], decode acc: [0.8747516870498657], forward-backward acc: [0.9262831211090088]
    training decode acc: [0.9215907454490662], training forward-backward acc: [0.9262831211090088]

- in comparison, weights generated from the expected word count give accuracy 92.181% (Viterbi decoding method) and 91.631% (marginal method) on test set.

Usage:
The commands for running the CRF training are
python crf.py pos/train pos/test 1     (for GPU training)
python crf.py pos/train pos/test 0     (for CPU training)




Appendix:
the training log is attached below:

==================== training log (w/o l1)  =============
with word count weights, decode acc: [0.9163079857826233], forward-backward acc: [0.9218129515647888]
training config: lr=0.002, max_iter=100000
iteration [0/50000], elapsed time [00:00:00], decode acc: [0.11721854656934738], forward-backward acc: [0.11055463552474976]
    training decode acc: [0.11922826617956161], training forward-backward acc: [0.11055463552474976]
iteration [1000/50000], elapsed time [00:00:10], decode acc: [0.7942053079605103], forward-backward acc: [0.7978891134262085]
    training decode acc: [0.8067935705184937], training forward-backward acc: [0.7978891134262085]
iteration [2000/50000], elapsed time [00:00:20], decode acc: [0.8739238381385803], forward-backward acc: [0.8791390657424927]
    training decode acc: [0.8958425521850586], training forward-backward acc: [0.8791390657424927]
iteration [3000/50000], elapsed time [00:00:29], decode acc: [0.867466926574707], forward-backward acc: [0.889197051525116]
    training decode acc: [0.9039340615272522], training forward-backward acc: [0.889197051525116]
iteration [4000/50000], elapsed time [00:00:39], decode acc: [0.6609271764755249], forward-backward acc: [0.8959023356437683]
    training decode acc: [0.7095300555229187], training forward-backward acc: [0.8959023356437683]
iteration [5000/50000], elapsed time [00:00:49], decode acc: [0.4358857572078705], forward-backward acc: [0.90177983045578]
    training decode acc: [0.4469371438026428], training forward-backward acc: [0.90177983045578]
iteration [6000/50000], elapsed time [00:00:59], decode acc: [0.41924670338630676], forward-backward acc: [0.9042218923568726]
    training decode acc: [0.4328303933143616], training forward-backward acc: [0.9042218923568726]
iteration [7000/50000], elapsed time [00:01:08], decode acc: [0.47280630469322205], forward-backward acc: [0.90475994348526]
    training decode acc: [0.49592289328575134], training forward-backward acc: [0.90475994348526]
iteration [8000/50000], elapsed time [00:01:18], decode acc: [0.47127485275268555], forward-backward acc: [0.9133692383766174]
    training decode acc: [0.4947580099105835], training forward-backward acc: [0.9133692383766174]
iteration [9000/50000], elapsed time [00:01:28], decode acc: [0.3781042993068695], forward-backward acc: [0.915687084197998]
    training decode acc: [0.37993574142456055], training forward-backward acc: [0.915687084197998]
iteration [10000/50000], elapsed time [00:01:38], decode acc: [0.3480132520198822], forward-backward acc: [0.9179635643959045]
    training decode acc: [0.3453153371810913], training forward-backward acc: [0.9179635643959045]
iteration [11000/50000], elapsed time [00:01:48], decode acc: [0.39023178815841675], forward-backward acc: [0.918956995010376]
    training decode acc: [0.3890063464641571], training forward-backward acc: [0.918956995010376]
iteration [12000/50000], elapsed time [00:01:58], decode acc: [0.43307119607925415], forward-backward acc: [0.9194122552871704]
    training decode acc: [0.4375753402709961], training forward-backward acc: [0.9194122552871704]
iteration [13000/50000], elapsed time [00:02:08], decode acc: [0.5119619369506836], forward-backward acc: [0.9214817881584167]
    training decode acc: [0.5338346362113953], training forward-backward acc: [0.9214817881584167]
iteration [14000/50000], elapsed time [00:02:18], decode acc: [0.5976407527923584], forward-backward acc: [0.9223924279212952]
    training decode acc: [0.636965274810791], training forward-backward acc: [0.9223924279212952]
iteration [15000/50000], elapsed time [00:02:28], decode acc: [0.6528145670890808], forward-backward acc: [0.9236341118812561]
    training decode acc: [0.7030879855155945], training forward-backward acc: [0.9236341118812561]
iteration [16000/50000], elapsed time [00:02:38], decode acc: [0.6847268342971802], forward-backward acc: [0.9240066409111023]
    training decode acc: [0.7418532967567444], training forward-backward acc: [0.9240066409111023]
iteration [17000/50000], elapsed time [00:02:49], decode acc: [0.7069536447525024], forward-backward acc: [0.9247102737426758]
    training decode acc: [0.7676265835762024], training forward-backward acc: [0.9247102737426758]
iteration [18000/50000], elapsed time [00:02:59], decode acc: [0.7326986789703369], forward-backward acc: [0.9256208539009094]
    training decode acc: [0.7952978014945984], training forward-backward acc: [0.9256208539009094]
iteration [19000/50000], elapsed time [00:03:09], decode acc: [0.7491722106933594], forward-backward acc: [0.9269453883171082]
    training decode acc: [0.8200768828392029], training forward-backward acc: [0.9269453883171082]
iteration [20000/50000], elapsed time [00:03:20], decode acc: [0.7740480303764343], forward-backward acc: [0.9272351264953613]
    training decode acc: [0.8451547026634216], training forward-backward acc: [0.9272351264953613]
iteration [21000/50000], elapsed time [00:03:30], decode acc: [0.7883692383766174], forward-backward acc: [0.9279387593269348]
    training decode acc: [0.8601175546646118], training forward-backward acc: [0.9279387593269348]
iteration [22000/50000], elapsed time [00:03:40], decode acc: [0.7983030080795288], forward-backward acc: [0.928062915802002]
    training decode acc: [0.8694994449615479], training forward-backward acc: [0.928062915802002]
iteration [23000/50000], elapsed time [00:03:49], decode acc: [0.8149834275245667], forward-backward acc: [0.928062915802002]
    training decode acc: [0.8818914890289307], training forward-backward acc: [0.928062915802002]
iteration [24000/50000], elapsed time [00:03:59], decode acc: [0.8226821422576904], forward-backward acc: [0.9278559684753418]
    training decode acc: [0.8877360224723816], training forward-backward acc: [0.9278559684753418]
iteration [25000/50000], elapsed time [00:04:09], decode acc: [0.8297185301780701], forward-backward acc: [0.9279801249504089]
    training decode acc: [0.8935755491256714], training forward-backward acc: [0.9279801249504089]
iteration [26000/50000], elapsed time [00:04:20], decode acc: [0.8407284617424011], forward-backward acc: [0.9276903867721558]
    training decode acc: [0.9000552892684937], training forward-backward acc: [0.9276903867721558]
iteration [27000/50000], elapsed time [00:04:30], decode acc: [0.8486341238021851], forward-backward acc: [0.9276903867721558]
    training decode acc: [0.9059299230575562], training forward-backward acc: [0.9276903867721558]
iteration [28000/50000], elapsed time [00:04:41], decode acc: [0.8530629277229309], forward-backward acc: [0.9276490211486816]
    training decode acc: [0.9103886485099792], training forward-backward acc: [0.9276490211486816]
iteration [29000/50000], elapsed time [00:04:51], decode acc: [0.8573261499404907], forward-backward acc: [0.9274834394454956]
    training decode acc: [0.9133486151695251], training forward-backward acc: [0.9274834394454956]
iteration [30000/50000], elapsed time [00:05:01], decode acc: [0.861175537109375], forward-backward acc: [0.9274420738220215]
    training decode acc: [0.9166449308395386], training forward-backward acc: [0.9274420738220215]
iteration [31000/50000], elapsed time [00:05:12], decode acc: [0.8634933829307556], forward-backward acc: [0.9273179173469543]
    training decode acc: [0.9188039898872375], training forward-backward acc: [0.9273179173469543]
iteration [32000/50000], elapsed time [00:05:22], decode acc: [0.865728497505188], forward-backward acc: [0.9272764921188354]
    training decode acc: [0.9207647442817688], training forward-backward acc: [0.9272764921188354]
iteration [33000/50000], elapsed time [00:05:33], decode acc: [0.8697847723960876], forward-backward acc: [0.9274834394454956]
    training decode acc: [0.923674464225769], training forward-backward acc: [0.9274834394454956]
iteration [34000/50000], elapsed time [00:05:44], decode acc: [0.8704056143760681], forward-backward acc: [0.9273179173469543]
    training decode acc: [0.9251983761787415], training forward-backward acc: [0.9273179173469543]
iteration [35000/50000], elapsed time [00:05:54], decode acc: [0.8728063106536865], forward-backward acc: [0.9273179173469543]
    training decode acc: [0.9266444444656372], training forward-backward acc: [0.9273179173469543]
iteration [36000/50000], elapsed time [00:06:04], decode acc: [0.8748344779014587], forward-backward acc: [0.9271109700202942]
    training decode acc: [0.9269130825996399], training forward-backward acc: [0.9271109700202942]
iteration [37000/50000], elapsed time [00:06:14], decode acc: [0.8752897381782532], forward-backward acc: [0.9270281791687012]
    training decode acc: [0.92786705493927], training forward-backward acc: [0.9270281791687012]
iteration [38000/50000], elapsed time [00:06:24], decode acc: [0.8764486908912659], forward-backward acc: [0.9271109700202942]
    training decode acc: [0.9280955195426941], training forward-backward acc: [0.9271109700202942]
iteration [39000/50000], elapsed time [00:06:34], decode acc: [0.8775662183761597], forward-backward acc: [0.9269039630889893]
    training decode acc: [0.9283440709114075], training forward-backward acc: [0.9269039630889893]
iteration [40000/50000], elapsed time [00:06:44], decode acc: [0.8776076436042786], forward-backward acc: [0.9271109700202942]
    training decode acc: [0.9274879693984985], training forward-backward acc: [0.9271109700202942]
iteration [41000/50000], elapsed time [00:06:54], decode acc: [0.878228485584259], forward-backward acc: [0.9270281791687012]
    training decode acc: [0.9277265071868896], training forward-backward acc: [0.9270281791687012]
iteration [42000/50000], elapsed time [00:07:04], decode acc: [0.8782699108123779], forward-backward acc: [0.926738440990448]
    training decode acc: [0.9272093176841736], training forward-backward acc: [0.926738440990448]
iteration [43000/50000], elapsed time [00:07:14], decode acc: [0.8776904344558716], forward-backward acc: [0.9269453883171082]
    training decode acc: [0.9265891909599304], training forward-backward acc: [0.9269453883171082]
iteration [44000/50000], elapsed time [00:07:24], decode acc: [0.8774420619010925], forward-backward acc: [0.926821231842041]
    training decode acc: [0.9260318875312805], training forward-backward acc: [0.926821231842041]
iteration [45000/50000], elapsed time [00:07:34], decode acc: [0.8772351145744324], forward-backward acc: [0.9264487028121948]
    training decode acc: [0.9255347847938538], training forward-backward acc: [0.9264487028121948]
iteration [46000/50000], elapsed time [00:07:43], decode acc: [0.8768625855445862], forward-backward acc: [0.9264487028121948]
    training decode acc: [0.924568235874176], training forward-backward acc: [0.9264487028121948]
iteration [47000/50000], elapsed time [00:07:55], decode acc: [0.8767797946929932], forward-backward acc: [0.9263659119606018]
    training decode acc: [0.9235564470291138], training forward-backward acc: [0.9263659119606018]
iteration [48000/50000], elapsed time [00:08:05], decode acc: [0.8758692145347595], forward-backward acc: [0.9263245463371277]
    training decode acc: [0.9226652383804321], training forward-backward acc: [0.9263245463371277]
iteration [49000/50000], elapsed time [00:08:15], decode acc: [0.8752069473266602], forward-backward acc: [0.9259933829307556]
    training decode acc: [0.922082781791687], training forward-backward acc: [0.9259933829307556]
iteration [50000/50000], elapsed time [00:08:25], decode acc: [0.8747516870498657], forward-backward acc: [0.9262831211090088]
    training decode acc: [0.9215907454490662], training forward-backward acc: [0.9262831211090088]


==================== training log (w/ l1)  =============
with word count weights, decode acc: [0.9163079857826233], forward-backward acc: [0.9218129515647888]
training config: lr=0.002, max_iter=100000
iteration [0/50000], elapsed time [00:00:00], decode acc: [0.11841887980699539], forward-backward acc: [0.11299668997526169]
    training decode acc: [0.11901988834142685], training forward-backward acc: [0.11299668997526169]
iteration [1000/50000], elapsed time [00:00:10], decode acc: [0.7898592948913574], forward-backward acc: [0.7790976762771606]
    training decode acc: [0.8011850118637085], training forward-backward acc: [0.7790976762771606]
iteration [2000/50000], elapsed time [00:00:21], decode acc: [0.8766970634460449], forward-backward acc: [0.8793460130691528]
    training decode acc: [0.896608293056488], training forward-backward acc: [0.8793460130691528]
iteration [3000/50000], elapsed time [00:00:32], decode acc: [0.8964403867721558], forward-backward acc: [0.8981788158416748]
    training decode acc: [0.922092854976654], training forward-backward acc: [0.8981788158416748]
iteration [4000/50000], elapsed time [00:00:43], decode acc: [0.907905638217926], forward-backward acc: [0.9081953763961792]
    training decode acc: [0.9347911477088928], training forward-backward acc: [0.9081953763961792]
iteration [5000/50000], elapsed time [00:00:54], decode acc: [0.920529842376709], forward-backward acc: [0.9216473698616028]
    training decode acc: [0.9522620439529419], training forward-backward acc: [0.9216473698616028]
iteration [6000/50000], elapsed time [00:01:05], decode acc: [0.9269453883171082], forward-backward acc: [0.9284768104553223]
    training decode acc: [0.9574965238571167], training forward-backward acc: [0.9284768104553223]
iteration [7000/50000], elapsed time [00:01:16], decode acc: [0.9317880868911743], forward-backward acc: [0.9327400922775269]
    training decode acc: [0.960192859172821], training forward-backward acc: [0.9327400922775269]
iteration [8000/50000], elapsed time [00:01:27], decode acc: [0.9328228831291199], forward-backward acc: [0.9349752068519592]
    training decode acc: [0.9622113108634949], training forward-backward acc: [0.9349752068519592]
iteration [9000/50000], elapsed time [00:01:38], decode acc: [0.9334437251091003], forward-backward acc: [0.9364238381385803]
    training decode acc: [0.9636900424957275], training forward-backward acc: [0.9364238381385803]
iteration [10000/50000], elapsed time [00:01:50], decode acc: [0.9333195686340332], forward-backward acc: [0.9388659000396729]
    training decode acc: [0.9644482135772705], training forward-backward acc: [0.9388659000396729]
iteration [11000/50000], elapsed time [00:02:01], decode acc: [0.9338990449905396], forward-backward acc: [0.9394867420196533]
    training decode acc: [0.9650984406471252], training forward-backward acc: [0.9394867420196533]
iteration [12000/50000], elapsed time [00:02:12], decode acc: [0.935844361782074], forward-backward acc: [0.9403145909309387]
    training decode acc: [0.9656256437301636], training forward-backward acc: [0.9403145909309387]
iteration [13000/50000], elapsed time [00:02:23], decode acc: [0.9359685778617859], forward-backward acc: [0.9401904344558716]
    training decode acc: [0.9660449028015137], training forward-backward acc: [0.9401904344558716]
iteration [14000/50000], elapsed time [00:02:34], decode acc: [0.9355546236038208], forward-backward acc: [0.9399420619010925]
    training decode acc: [0.9664667248725891], training forward-backward acc: [0.9399420619010925]
iteration [15000/50000], elapsed time [00:02:45], decode acc: [0.9360513687133789], forward-backward acc: [0.9404801726341248]
    training decode acc: [0.9667754769325256], training forward-backward acc: [0.9404801726341248]
iteration [16000/50000], elapsed time [00:02:56], decode acc: [0.93600994348526], forward-backward acc: [0.940562903881073]
    training decode acc: [0.9670566916465759], training forward-backward acc: [0.940562903881073]
iteration [17000/50000], elapsed time [00:03:07], decode acc: [0.935927152633667], forward-backward acc: [0.9404801726341248]
    training decode acc: [0.9673152565956116], training forward-backward acc: [0.9404801726341248]
iteration [18000/50000], elapsed time [00:03:17], decode acc: [0.9354304671287537], forward-backward acc: [0.940645694732666]
    training decode acc: [0.9674859642982483], training forward-backward acc: [0.940645694732666]
iteration [19000/50000], elapsed time [00:03:28], decode acc: [0.935844361782074], forward-backward acc: [0.9401904344558716]
    training decode acc: [0.9676818251609802], training forward-backward acc: [0.9401904344558716]
iteration [20000/50000], elapsed time [00:03:38], decode acc: [0.9353063106536865], forward-backward acc: [0.9403145909309387]
    training decode acc: [0.9678751230239868], training forward-backward acc: [0.9403145909309387]
iteration [21000/50000], elapsed time [00:03:50], decode acc: [0.9351821541786194], forward-backward acc: [0.9405215382575989]
    training decode acc: [0.9680056571960449], training forward-backward acc: [0.9405215382575989]
iteration [22000/50000], elapsed time [00:04:01], decode acc: [0.9351821541786194], forward-backward acc: [0.940562903881073]
    training decode acc: [0.9681136012077332], training forward-backward acc: [0.940562903881073]
iteration [23000/50000], elapsed time [00:04:12], decode acc: [0.9348924160003662], forward-backward acc: [0.9404801726341248]
    training decode acc: [0.9683345556259155], training forward-backward acc: [0.9404801726341248]
iteration [24000/50000], elapsed time [00:04:23], decode acc: [0.9348924160003662], forward-backward acc: [0.9403145909309387]
    training decode acc: [0.9684575796127319], training forward-backward acc: [0.9403145909309387]
iteration [25000/50000], elapsed time [00:04:34], decode acc: [0.934685468673706], forward-backward acc: [0.9401490092277527]
    training decode acc: [0.9684450030326843], training forward-backward acc: [0.9401490092277527]
iteration [26000/50000], elapsed time [00:04:46], decode acc: [0.9341059923171997], forward-backward acc: [0.9404387474060059]
    training decode acc: [0.9685580134391785], training forward-backward acc: [0.9404387474060059]
iteration [27000/50000], elapsed time [00:04:57], decode acc: [0.9343129396438599], forward-backward acc: [0.9407699108123779]
    training decode acc: [0.9686056971549988], training forward-backward acc: [0.9407699108123779]
iteration [28000/50000], elapsed time [00:05:08], decode acc: [0.9343129396438599], forward-backward acc: [0.940728485584259]
    training decode acc: [0.9686107039451599], training forward-backward acc: [0.940728485584259]
iteration [29000/50000], elapsed time [00:05:18], decode acc: [0.934271514415741], forward-backward acc: [0.9402731657028198]
    training decode acc: [0.9687663316726685], training forward-backward acc: [0.9402731657028198]
iteration [30000/50000], elapsed time [00:05:29], decode acc: [0.9341059923171997], forward-backward acc: [0.9403973817825317]
    training decode acc: [0.9688316583633423], training forward-backward acc: [0.9403973817825317]
iteration [31000/50000], elapsed time [00:05:40], decode acc: [0.9339404106140137], forward-backward acc: [0.940562903881073]
    training decode acc: [0.9687989950180054], training forward-backward acc: [0.940562903881073]
iteration [32000/50000], elapsed time [00:05:51], decode acc: [0.9339404106140137], forward-backward acc: [0.9406871199607849]
    training decode acc: [0.9688617587089539], training forward-backward acc: [0.9406871199607849]
iteration [33000/50000], elapsed time [00:06:01], decode acc: [0.9334850907325745], forward-backward acc: [0.940562903881073]
    training decode acc: [0.9689345359802246], training forward-backward acc: [0.940562903881073]
iteration [34000/50000], elapsed time [00:06:12], decode acc: [0.9334437251091003], forward-backward acc: [0.940562903881073]
    training decode acc: [0.9690600633621216], training forward-backward acc: [0.940562903881073]
iteration [35000/50000], elapsed time [00:06:23], decode acc: [0.9334437251091003], forward-backward acc: [0.940645694732666]
    training decode acc: [0.9691103100776672], training forward-backward acc: [0.940645694732666]
iteration [36000/50000], elapsed time [00:06:34], decode acc: [0.9338576197624207], forward-backward acc: [0.9406043291091919]
    training decode acc: [0.9691479802131653], training forward-backward acc: [0.9406043291091919]
iteration [37000/50000], elapsed time [00:06:46], decode acc: [0.9333195686340332], forward-backward acc: [0.940645694732666]
    training decode acc: [0.9691429138183594], training forward-backward acc: [0.940645694732666]
iteration [38000/50000], elapsed time [00:06:57], decode acc: [0.9332781434059143], forward-backward acc: [0.940562903881073]
    training decode acc: [0.9691780805587769], training forward-backward acc: [0.940562903881073]
iteration [39000/50000], elapsed time [00:07:08], decode acc: [0.9337334632873535], forward-backward acc: [0.9404387474060059]
    training decode acc: [0.9691705703735352], training forward-backward acc: [0.9404387474060059]
iteration [40000/50000], elapsed time [00:07:19], decode acc: [0.9334850907325745], forward-backward acc: [0.9406043291091919]
    training decode acc: [0.9692031741142273], training forward-backward acc: [0.9406043291091919]
iteration [41000/50000], elapsed time [00:07:30], decode acc: [0.933112621307373], forward-backward acc: [0.9401904344558716]
    training decode acc: [0.9691705703735352], training forward-backward acc: [0.9401904344558716]
iteration [42000/50000], elapsed time [00:07:42], decode acc: [0.9336920976638794], forward-backward acc: [0.9403559565544128]
    training decode acc: [0.9692684412002563], training forward-backward acc: [0.9403559565544128]
iteration [43000/50000], elapsed time [00:07:52], decode acc: [0.9332367777824402], forward-backward acc: [0.9401904344558716]
    training decode acc: [0.9692056775093079], training forward-backward acc: [0.9401904344558716]
iteration [44000/50000], elapsed time [00:08:04], decode acc: [0.9332781434059143], forward-backward acc: [0.9400662183761597]
    training decode acc: [0.9692935943603516], training forward-backward acc: [0.9400662183761597]
iteration [45000/50000], elapsed time [00:08:15], decode acc: [0.932947039604187], forward-backward acc: [0.9401904344558716]
    training decode acc: [0.9693036079406738], training forward-backward acc: [0.9401904344558716]
iteration [46000/50000], elapsed time [00:08:26], decode acc: [0.932781457901001], forward-backward acc: [0.9401490092277527]
    training decode acc: [0.9694015383720398], training forward-backward acc: [0.9401490092277527]
iteration [47000/50000], elapsed time [00:08:37], decode acc: [0.9333195686340332], forward-backward acc: [0.9404387474060059]
    training decode acc: [0.9693512916564941], training forward-backward acc: [0.9404387474060059]
iteration [48000/50000], elapsed time [00:08:48], decode acc: [0.933112621307373], forward-backward acc: [0.9400248527526855]
    training decode acc: [0.9693864583969116], training forward-backward acc: [0.9400248527526855]
iteration [49000/50000], elapsed time [00:08:58], decode acc: [0.9332367777824402], forward-backward acc: [0.9403559565544128]
    training decode acc: [0.9693990349769592], training forward-backward acc: [0.9403559565544128]
iteration [50000/50000], elapsed time [00:09:09], decode acc: [0.9323261976242065], forward-backward acc: [0.9405215382575989]
    training decode acc: [0.9693161845207214], training forward-backward acc: [0.9405215382575989]
